# <center>“畅游中国”火车售票系统需求规格说明书</center><center>[需求规格说明书]<center>

<br>

<center><font size=4>组长：薛天钰</font></center>

<center><font size=4>小组成员：杨一堂、马子杰、陈心扬、赵琳慧</font><center>

<br>

<center><font size="6"><strong>目录</strong></font></center>

[TOC]



## 1.     概述

### 1.1 用户简介

“畅游中国”火车售票系统的用户主要是希望购买中国大陆地区铁路车票的消费者。为了网站的正常运营，也需要系统管理员和铁路系统员对信息进行管理。

#### 1.1.1      游客

在实际操作中，没有注册并登录的用户。游客可以浏览本站主界面，但是不能进行购票、查询等其他所有操作。当游客要使用这些操作时，需要登录账号。游客可以通过注册来获得新的账号。

#### 1.1.2      登录用户

在实际操作中，拥有本站账号并登录的用户。登录用户可使用他注册过的账号进行登录，即拥有购票所需要的全部权限，可以进行查询车次、购票、操作订单、充值等操作。

#### 1.1.3      系统管理员用户

在实际操作中，拥有系统管理员账号并登录的用户。系统管理员用户可以查阅和修改所有的用户信息和用户账户信息。

#### 1.1.4      铁路系统员用户

在实际操作中，拥有铁路系统员账号并登录的用户。铁路系统员用户可以增加和删除火车铁路车次信息。

### 1.2 项目的目的与目标

随着社会经济的发展，中国居民的出行需求日益增加，铁路已经成为很多人选择的主要出行方式。根据交通运输部《2021年铁道统计公报》数据，我国2021年铁路旅客发送量达26.12亿人。如此大的铁路客运量，也催生了居民对于便捷地购买火车票的广阔市场需求。在这样的背景下，“畅游中国”火车售票系统应运而生。

“畅游中国”火车售票系统的网站旨在提供一个方便、可靠、高效的售票平台，使用户可以在线预订、购买火车票。该系统的目的是为用户提供一个简单、便捷的购票体验，同时提高火车站售票效率，减少人工售票的负担。

以实现所有基础需求为保证、以进一步提高用户体验为拓展，我们提出目标：

1. 提供一个易于使用的用户界面：该系统的用户界面应该是易于使用和直观的，让用户能够轻松地找到需要的信息，并快速完成购票流程。

2. 提供准确的车票信息：该系统需要提供准确的车票信息，包括列车编号、出发地、目的地、发车时间、到达时间、车票价格和余票数量等。

3. 提供安全的支付渠道：该系统需要提供安全的支付渠道，确保用户的支付信息不会被泄露或被不良分子利用
4. 提供可靠的后台管理系统：该系统需要提供一个可靠的后台管理系统，以确保管理员可以管理和监控系统的运行情况，并对可能出现的问题进行快速响应和处理。

5. 提高售票效率：该系统的目标是提高售票效率，减少火车站售票的人力成本。通过提供在线购票功能，减少火车站售票窗口的排队时间和拥挤情况。

6. 提高用户满意度：该系统的目标是提高用户满意度，为用户提供高质量、便捷、快速的购票体验。同时，该系统还应该提供良好的客户服务，对用户的问题和反馈做出及时、准确的响应。

### 1.3 阅读对象

本需求规格说明书的预期读者包括：

* 项目组成员

* 测试组成员

* 技术部负责人

* SQA人员

* 开发者授权调阅本文档的其他人员

### 1.4 软件需求分析理论

软件需求分析是研究用户需求得到的东西，完全理解用户对软件需求的完整功能，确认用户软件功能需求， 建立可确认的、可验证的一个基本依据。软件需求分析是一个项目的开端， 也是项目实施最重要的关键点。 据有关的机构分析结果表明， 设计的软件产品存在不完整性、 不正确性等问题 80％以上是需求分析错误所导致的，而且由于需求分析错误造成根本性的功能问题尤为突出。因此，一个项目的成功软件需求分析是关键的一步。

### 1.5 软件需求分析目标

1. 对实现软件的功能做全面的描述，帮助用户判断实现功能的正确性、一致性和完整性，促使用户在软件设计启动之前周密地、全面地思考软件需求。了解和描述软件实现所需的全部信息，为软件设计、确认和验证提供一个基准。

2. 为软件管理人员进行软件成本计价和编制软件开发计划书提供依据。

3. 需求分析的具体内容可以归纳为六个方面： 软件的功能需求， 软件与硬件或其他外部系统接口，软件的非功能性需求， 软件的反向需求， 软件设计和实现上的限制，阅读支持信息。

4. 软件需求分析应尽量提供软件实现功能需求的全部信息， 使得软件设计人员和软件测试人员不再需要需求方的接触。 这就要求软件需求分析内容应正确、 完整、一致和可验证。此外，为保证软件设计质量，便于软件功能的休整和验证，软件需求表达无岔意性，具有可追踪性和可修改性。

## 2.  结构化自然语言需求

### 2.1 角色定义

“畅游中国”火车售票系统角色定义见表2-1。

<center>表 2-1 系统角色定义表</center>

| 编号 | 角色                       | 职责         | 相关的业务                 |
| ---- | -------------------------- | ------------ | -------------------------- |
| 01   | 游客                       | 无           | 浏览主页面、注册、登录     |
| 02   | 登录用户（以下简称“用户”） | 无           | 查询、购票、操作订单、充值 |
| 03   | 系统管理员                 | 管理用户信息 | 查询和修正用户信息         |
| 04   | 铁路系统员                 | 管理车次信息 | 增加、删除和修改车次信息   |

### 2.2 用户故事与交互流程

#### 2.2.1 注册

当游客选择注册时，系统应该允许用户输入用户名、密码、电子邮件和其他个人信息，并验证这些信息的有效性。如果信息有效，系统应该创建一个新的用户账户，并提示用户注册成功。如果信息无效，系统应该提示游客重新输入或取消注册。

```txt
基本流程 {
    （游客）1.游客点击“注册”按钮
    （系统）2.系统打开注册界面
    （游客）3.游客输入用户名.密码.电子邮件和其他个人信息
    （系统）4.系统向游客发送验证信息
    （游客）5.游客验证信息正确性，系统做出响应
        （选择）5a.信息有效
            （系统）1.系统用以上信息创建新的用户账户，并提示游客注册成功。
        （选择）5b.信息无效
            （系统）1.提示游客重新输入
}

扩展流程 {
    （可选）*a.游客放弃当前任务，选择返回登陆界面
        （游客）1.点击“返回”按钮
        （系统）2.放弃当前动作，返回登陆界面
    （可选）5b1a.取消注册
        （游客）1.游客点击“取消注册”按钮
        （系统）2.放弃当前动作，返回登陆界面
}
```

#### 2.2.2 账户设置

当用户选择账户设置时，系统应该显示用户的当前账户列表，并提供添加新账户的选项。如果用户选择添加新账户，系统应该允许用户输入账户名称、类型和初始余额，并验证这些信息的有效性。如果信息有效，系统应该创建一个新的账户，并提示用户添加成功。如果信息无效，系统应该提示用户重新输入或取消添加。

当用户选择一个已有的账户时，系统应该显示该账户的详细信息，并提供充值的选项。如果用户选择充值，系统应该允许用户输入充值金额，并验证该金额的有效性。如果金额有效，系统应该更新该账户的余额，并提示用户充值成功。如果金额无效，系统应该提示用户重新输入或取消充值。

```txt
基本流程 {
    （可选）*a.用户放弃当前任务，选择返回主页
        （用户）1.点击“主页”按钮
        （系统）2.放弃当前动作，返回主页
    （异常处理）*b.系统发生错误（网络等原因）
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出并可能重试。
    （用户）1.用户点击“账户设置”按钮
    （系统）2.显示器显示用户当前账户列表，以及“添加新用户”按钮
    （用户）3.选择账户
        （选择）3a.用户选择添加新账户
            （用户）1.用户点击“添加新账户”按钮
            （系统）2.系统打开输入账户信息界面
            （用户）3.输入账户名称和类型
            （系统）4.向用户发送验证信息
            （用户）5.验证信息正确性，系统做出响应
                （选择）5a.信息有效
                    （系统）1.根据上述信息创建一个新账户，并提示用户添加账户成功
                （选择）5b.信息无效
                    （系统）1.提示用户重新输入
        （选择）3b.用户选择已有账户
            （用户）1.用户点击已有的某个账户的按钮
            （系统）2.系统显示该账户的详细信息，并提供充值选项
}
扩展流程 {
    （异常处理）*b.系统发生错误（网络等原因）
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出并可能重试。
    （可选）3a5b1a.用户选择取消添加账户
        （用户）1.点击“取消添加账户”按钮
        （系统）2.放弃当前动作，返回账户列表界面

    (可选)3b2a.用户选择充值
        （用户）1.用户点击“充值”按钮
        （系统）2.系统打开输入充值金额页面
        （系统）3.向用户发送验证信息
        （用户）4.验证金额有效性，系统做出响应
            （选择）4a.信息有效
                （系统）1.更新该账户余额，并提示充值成功
            （选择）4b.信息无效
                （系统）1.提示用户重新输入
                （可选）1a.用户选择取消充值
                    （用户）1.用户点击“取消充值”按钮
                    （系统）2.放弃当前动作，返回显示账户详细信息界面
}

非功能需求 {
    1.系统出现错误时，能够及时报告错误信息并提供退出方式
    2.95%的情况下添加新账户时间（提交添加账户申请到切换到新账户登录状态）不超过3秒，充值时间（有效性检查和充值任务执行）不超过5秒。
}
```

#### 2.2.3 系统管理员

系统应该提供一个管理员界面，允许系统管理员登录并管理所有用户信息以及用户账户信息。系统管理员可以查看、修改、删除和添加用户和账户的相关信息。系统应该验证系统管理员的身份，并记录其操作的日志。

```txt
作为一个管理员，我想要查看用户及用户账户信息，以便于管理用户和账户。
基本流程 {
    （用户） 1.用户应点击“管理”按钮。
    （系统） 2.系统应显示验证管理员身份界面。
    （用户） 3.用户应出示相应证明。
    （系统） 4.系统应验证用户的管理员身份。
    （系统） 5.系统应显示所有的用户列表及相应的用户账户列表。
    （用户） 6.用户应选择需要进行操作的用户或账户。
    （系统） 7.系统应显示相应的用户或账户信息。
    （用户） 8.用户应选择需要的进行的管理操作并进行操作。
    （系统） 9.系统应进行相应的操作。
    （系统） 10.系统应提示用户确认。
    （用户） 11.用户应确认本次操作。
    （系统） 12.系统应根据用户的相应操作更改相应信息。
    （系统） 13.系统应记录本次操作的日志。
    （系统） 14.系统应显示操作成功。
    （循环5~14直至输入结束）
    （用户） 15.用户应退出相应管理界面。
}

扩展流程 {
    （异常处理）*a.系统发生错误：
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出界面。
    （异常处理）4a.管理员身份验证失败：
        （系统）1.系统应显示管理员身份验证失败的提示。
        （系统）2.系统应退出界面。
    （可选）6~10a.用户在确认操作前的任意步骤中，都应能撤回到之前的步骤。
    （选择）6a.用户选择查看信息：
    （选择）6b.用户选择修改信息：
        （用户）1.用户应选择需要更改的信息。
        （用户）2.用户应输入更改后的信息。
    （选择）6c.用户选择删除信息：
        （用户）1.用户应选择需要删除的信息。
    （选择）6d.用户选择添加信息：
        （用户）1.用户应输入需要添加的信息。
}

非功能需求：{
    1.在系统出现错误时，能够及时发现错误信息并提示。
    2.在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。
}
```

#### 2.2.4 铁路系统员

当铁路系统员选择设置火车铁路运行车次时，系统应该允许铁路系统员输入该车次的火车信息、起始火车站台以及沿途的火车站台信息、火车不同的座位信息、发车日期时间以及到各个站台的时间，并验证这些信息的有效性和一致性。如果信息有效且一致，系统应该创建一个新的火车铁路运行车次，并提示铁路系统员设置成功。如果信息无效或不一致，系统应该提示铁路系统员重新输入或取消设置。

```txt
作为一个铁路系统员，我想要输入火车铁路运行车次信息，以便于设置火车铁路运行车次
基本流程 {
    （用户） 1.用户点击“输入车次信息”按钮。
    （系统） 2.系统应显示输入信息界面。
    （用户） 3.用户应新建一车次，并输入该车次的火车信息.起始火车站台以及沿途的火车站台信息.火车不同的座位信息.发车日期时间以及到各个站台的时间。
    （系统） 4.系统应验证信息的有效性和一致性。
    （系统） 5.系统应显示所有输入的信息，并提示用户确认。
    （用户） 6.用户应确认信息。
    （系统） 7.系统应创建相应的新的火车铁路运行车次。
    （系统） 8.提示设置车次信息成功。
}

扩展流程 {
    （异常处理）*a.系统发生错误：
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出并可能重试。
    （可选）3~5a.用户在确认信息前的任意步骤中，都应能撤回到之前的步骤。
    （异常处理）4a.验证信息无效或不一致：
        （系统）1.系统应向用户提示“验证信息错误”。
        （用户）2.用户应修改输入信息。
}

非功能需求：{
    1.在系统出现错误时，能够及时发现错误信息并提示。
    2.在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。
}
```

#### 2.2.5 查询火车车次

当用户选择查询火车车次时，系统应该允许用户输入起点、终点以及乘坐日期，并验证这些信息的有效性。如果信息有效，系统应该返回该天所有能满足用户需求的车次信息，包括起始点满足，以及沿途的火车站台也能满足。如果信息无效，系统应该提示用户重新输入或取消查询。

系统应该提供一个高级需求按钮，允许用户通过不同的条件进行搜索，如最便宜和最快。如果用户选择高级需求按钮，系统应该显示不同的条件选项，并允许用户选择一个或多个条件。系统应该根据用户选择的条件对车次信息进行排序或过滤，并返回结果给用户。

系统应该给用户提供可以中转完成旅途的选择。如果用户选择中转选项，系统应该显示所有可以通过一次或多次中转到达终点的车次组合，并显示每个组合的总价格、总时间和中转次数。系统应该根据用户选择的高级需求条件对车次组合进行排序或过滤，并返回结果给用户。

```txt
作为一个用户，我想要查询火车车次，以便于选择适合自己的车次
基本流程 {
    （用户） 1.用户点击“输入”按钮。
    （用户） 2. 用户输入起点.终点以及乘坐日期。
    （系统） 3. 系统验证信息的有效性。
        （选择） 3a. 信息有效
            （系统） 1.返回该天所有能满足用户需求的车次信息（包括起始点满足，以及沿途的火车站台也能满足）
        （选择）3b. 信息无效
            （系统） 1.提示用户重新输入或取消查询
}

扩展流程 {
    （异常处理）*b.系统发生错误（网络等原因）
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出并可能重试。
    （可选）1a.用户选择高级需求按钮
        （系统） 1. 显示不同的条件选项
​        （用户） 2. 选择一个或者多个条件
        （系统） 3. 根据用户选择的条件对车次进行排序或者过滤
​        （系统） 4. 返回结果给用户
    （可选）2a.用户选择中转按钮
        （系统） 1. 所有可以通过一次或多次中转到达终点的车次组合
​        （系统） 2. 显示每个组合的总价格.总时间和中转次数
        （系统） 3. 根据用户选择的高级需求条件对车次进行排序或者过滤（系统） 4. 返回结果给用户
}

非功能需求：{
    1.在系统出现错误时，能够及时发现错误信息并提示。
    2.在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。在非高峰时间根据起始地点和日期等特定条件进行搜索，可以在2秒内得到搜索结果。
    3.系统应该保证用户只能查看和删除自己的订单，不能查看和删除其他用户的订单。
}
```

#### 2.2.6 购票

1）  当用户选择购票时，系统应该允许用户输入起始城市、目的地城市、日期，并验证这些信息的有效性。如果信息有效，系统应该显示所有符合用户需求的行程和座位类型，并提供选择的选项。如果信息无效，系统应该提示用户重新输入或取消购票。

当用户选择一个行程和座位类型后，系统应该检查用户是否已经登录。如果用户已经登录，系统应该显示用户的联系人列表，并提供选择或添加一个联系人的选项。如果用户没有登录，系统应该提示用户登录或注册。

当用户选择或添加一个联系人后，系统应该创建一个新的订单，并显示订单的详细信息和总价格。系统应该提供直接支付或稍后支付的选项。如果用户选择直接支付，系统应该跳转到支付界面，并允许用户选择支付方式并输入支付信息。如果用户选择稍后支付，系统应该提示用户可以在订单列表中找到并支付订单。

当用户在订单列表中找到并点击支付按钮时，系统应该跳转到支付界面，并允许用户选择支付方式并输入支付信息。

```txt
作为一个用户，我想要购票，以便乘火车出行
基本流程 {
    （用户）1. 用户应输入起始城市.目的地城市.日期
    （系统）2. 系统应根据用户输入查询符合条件的行程和座位信息
    （用户）3. 用户应选择行程和座位类型
    （系统）4. 系统应录入用户的行程选择
    （系统）5. 系统应列出联系人供用户选择
    （用户）6. 用户应设定某一联系人完成预定
    （系统）7. 系统应向用户显示订票金额
    （用户）8. 用户应支付订票金额
}

扩展流程 {
    （可选）*a. 用户在购票的任意步骤中，都应能撤回到之前的步骤
    （异常处理）*a. 系统在任何时间点发生错误
        （系统）1. 系统应输出异常日志
        （系统）2. 系统应告知用户发生异常
        （系统）3. 系统应保存用户已填写的信息，重新开始订票
    （异常处理）*b. 用户在任何时间点与系统断开连接
        （系统）1. 系统应保存用户已填写的信息
        （系统）2. 当用户重新登录系统时，系统应恢复本次购票流程。
    （异常处理）3a. 用户选择行程和座位类型，但并未登陆
        （系统）1. 系统应提醒用户登陆
    （选择）5a. 用户选择使用已有联系人
        （用户）1. 用户应选择联系人
        （系统）2. 系统应将用户的选择设定为本车票的联系人
    （选择）5b. 用户选择添加联系人
        （用户）1. 用户应输入新联系人的身份信息
        （系统）2. 系统应审核身份信息的正确性
            （选择）2a. 审核通过
                （系统）1. 系统应将新的联系人设定为本车票的联系人
            （选择）2b. 审核不通过
                （系统）1. 系统应提醒用户联系人信息存在错误
                （用户）2. 用户应重新填写新联系人的身份信息
                （重复5直到设定了成功设定某一联系人）
    （选择）7a. 用户选择立即支付
        （用户）1. 用户应直接进入线上支付系统进行支付
        （系统）2. 系统应完成收款，结束购票流程
    （选择）7b. 用户选择之后支付
        （用户）1. 用户应结束购票
        （用户）2. 用户应在订单列表中找到之前预订的票，点击支付按钮
        （用户）3. 用户应进入线上支付系统进行支付
        （系统）2. 系统应完成收款，结束购票流程
}

非功能性需求 {
    1. 在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。在非高峰时间根据起始地点和日期等特定条件进行搜索，可以在2秒内得到搜索结果。
    2. 严格权限访问控制，不同的用户具有不同的身份和权限，需要在用户身份真实可信的前提下，保护数据不被非法/越权访问和篡改，要确保数据的机密性和完整性。
}
```

#### 2.2.7 查看订单

系统应该允许用户查看自己的订单列表，包括已完成和未完成的订单。当用户选择删除订单时，系统应该检查订单的状态，如果订单已过期或未支付，系统应该删除订单，并更新订单列表。如果订单不能被删除，系统应该提示用户原因，并保留订单。系统应该保证用户只能查看和删除自己的订单，不能查看和删除其他用户的订单。

```txt
作为一个用户，我想要查看订单， 以便于对不同订单做相应的操作
基本流程 {
    （用户） 1.用户点击“订单”按钮。
    （系统） 2.系统应显示用户的订单列表，包括已完成和未完成的订单。
}

扩展流程 {
    （异常处理）*b.系统发生错误（网络等原因：
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出并可能重试。
    （可选）2a.用户选择删除订单
        （系统）1.检查订单状态，判断是否为已过期或未支付的订单（选择a1，b1，c1）
                （选择）a1.是已过期或未支付的订单
                    （系统）1.删除订单
                    （系统）2.更新订单列表
                （选择）b1.不是已过期或未支付的订单
                    （系统）1.提示用户原因
                    （系统）2.取消删除操作
                （选择）c1.删除过程中出现错误
                    （系统）1.提示用户原因
                    （系统）2.放弃删除操作
}

非功能需求：{
    1.在系统出现错误时，能够及时发现错误信息并提示。
    2.在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。在非高峰时间根据起始地点和日期等特定条件进行搜索，可以在2秒内得到搜索结果。
    3.系统应该保证用户只能查看和删除自己的订单，不能查看和删除其他用户的订单。
}
```

#### 2.2.8 取消订单

如果用户取消订单，系统应该允许用户在订单中心取消距离发车时间一个小时的订单，并退还用户支付的金额。

```txt
作为一个用户，我想要取消订单
基本流程 {
    （用户） 1.用户点击“订单中心”按钮。
    （用户） 2. 用户点击取消订单。
    （系统） 3. 系统判断是否距离发车时间一个小时。
    ​   （选择） 3a. 是
    ​       （系统） 1.显示取消成功
            （系统） 2.退还用户支付的金额
        （选择）3b. 否
            （系统） 1.提示用户取消失败
}
```

#### 2.2.9 改签

当用户选择改签时，系统应该显示用户的原始订单信息，包括起始点、目的地、时间和价格，并让用户选择新的时间。系统应该保证改签的起始点与原始订单一致，且改签的新时间不能超过原始时间的24小时。当用户确认改签时，系统应该计算差价，并根据差价退还或收取额外的费用。系统应该更新用户的订单信息，并提示用户改签成功。

```txt
作为一个用户，我想要改签， 以便于切换到更适宜的车次
基本流程 {
    （用户） 1.用户点击“改签”按钮。
    （系统） 2.系统应显示用户的原始订单信息，包括起始点.目的地.时间和价格。
    （用户） 3.用户应选择改签后的目的地
    （系统） 4.系统应显示所有可以改签到的车票信息，满足“改签的起始点与原始订单一致，且改签的新时间不能超过原始时间的24小时”
    （用户） 5.用户选择车票
    （系统） 6.系统应显示该车次的信息
    （5-6循环直到用户确定要改签或者放弃改签）
    （用户） 7.用户确认改签
    （系统） 8.系统应计算差价，并根据差价返还或收取费用
    （系统） 9.系统应取消原有订单，并创建新订单
    （系统） 10.系统应更新用户的订单列表
    （系统） 11.系统应提示用户改签成功
}

扩展流程 {
    （异常处理）*b.系统发生错误（网络等原因：
        （系统）1.系统应向用户提示相应错误信息。
        （用户）2.用户应退出并可能重试。
    （异常处理）*c.用户余额不足：
        （系统）1.系统应向用户提示“余额不足”。
        （用户）2.用户应切换到充值界面。
}

非功能需求：{
    1.在系统出现错误时，能够及时发现错误信息并提示
    2.在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。在非高峰时间根据起始地点和日期等特定条件进行搜索，可以在2秒内得到搜索结果。
    3.系统应该保证改签的起始点与原始订单一致，且改签的新时间不能超过原始时间的24小时。
}
```

#### 2.2.10 系统消息

当用户购票、改签或取消订单后，系统应该自动发送一条消息给用户，包含订单的相关信息和状态，并提示用户操作成功。系统应该保证消息的及时性和准确性，且不向用户发送无关或重复的消息。

```txt
作为一个用户，我想要收到相应的订单更改消息，以便于及时了解我的改订单情况。
基本流程 {
    （用户） 1.用户更改订单信息。
    （系统） 2.系统应发送订单相关信息和状态给用户。
    （系统） 3.系统应提示操作成功。
}

非功能需求：{
    1.系统应保证信息的及时性和准确性，且不向用户发送无关或重复的消息。
}
```

#### 2.2.11 修改或取消车次（铁路系统员）

系统应该允许工作人员修改或取消车次，输入紧急情况的原因，并确认操作。当工作人员修改或取消车次后，系统应该自动通知所有购买该车次的用户，包含车次的相关信息和状态，并说明紧急情况的原因。系统应该更新用户的订单信息，并提供用户免费改签的机会。系统应该保证工作人员只能修改或取消未发车的车次，不能修改或取消已发车的车次。系统应该保证通知的及时性和准确性，且不向用户发送无关或重复的通知。

```txt
作为一个工作人员，我希望能够取消或延误车次，以通知用户车次取消和延迟的消息
基本流程 {
    （用户）1. 工作人员应修改车次信息或取消车次
    （系统）2. 系统应根据工作人员提供的信息，修改或取消车次
    （系统）3. 系统应通知所有购票的用户，并修改用户的订单信息
    （用户）4. 用户收到系统的通知，应选择是否免费改签
}

扩展流程 {
    （选择）4a. 用户选择不进行改签
    （选择）4b. 用户选择进行改签
        （用户）1. 用户应选择改签后的行程
        （系统）2. 系统应修改用户的订单信息
}

非功能性需求 {
    1. 系统消息应能再车次修改后及时发送给用户，可通过用户填写的手机.邮箱等信息多渠道进行通知
}
```

## 3.模型化需求

### 3.1 用例图

![](.\img\用例图.jpg)

<center><font size=2>图3-1  用例图</font></center>
### 3.2 系统顺序图

#### 3.2.1 游客注册

![](.\img\用户注册.jpg)

<center><font size=2>图3-2  系统顺序图-游客注册</font></center>
#### 3.2.2 用户购票

![](.\img\用户购票.jpg)

<center><font size=2>图3-3  系统顺序图-用户购票</font></center>
#### 3.2.3 用户改签

![](.\img\用户改签.jpg)

<center><font size=2>图3-4  系统顺序图-用户改签</font></center>
#### 3.2.4 用户账户设置

![](.\img\用户账户设置.jpg)

<center><font size=2>图3-5  系统顺序图-用户账户设置</font></center>
### 3.3 概念类图

![](.\img\概念类图.jpg)

<center><font size=2>图3-6  概念类图</font></center>
### 3.4 操作合约及不变式

#### 3.4.1 注册

* 操作签名：register(usename:varchar,password:varchar,email:varchar)

* 交叉引用：注册，编辑个人资料
* 前置条件：资料内容必须合法
* 后置条件：
  * 创建了一个用户账户p（创建实例）
  * p实例的属性为设定为资料内容的值（修改为属性）。

* 不变式：赋予用户账户的id不能存在相同的情况。

#### 3.4.2 用户登录

* 操作签名：login(usename:varchar,password:varchar)
* 交叉引用：用户登录
* 前置条件：用户名和密码正确，且当前无账户登录。
* 后置条件：登录账户

* 不变式：无

#### 3.4.3 查询车次

* 操作签名：searchtrain(start：varchar，end：varchar，date：date)
* 交叉引用：查询车次
* 前置条件：用户登录
* 后置条件：展示对应车次

* 不变式：无

#### 3.4.4 订单查看

* 操作签名：checkbills()
* 交叉引用：订单查看
* 前置条件：用户登录
* 后置条件：显示订单

* 不变式：无

#### 3.4.5 删除订单

* 操作签名：deletebill(bill_id：int)
* 交叉引用：删除订单
* 前置条件：订单查看
* 后置条件：订单被删除，如果是未支付的订单，将票释放。

* 不变式：不能删除未出行的订单

#### 3.4.6 取消订单

* 操作签名：withdrawbill(bill_id：int)
* 交叉引用：取消订单
* 前置条件：订单查看
* 后置条件：订单被取消，将票释放，退款。

* 不变式：只能取消未出行的订单

#### 3.4.7 改签

* 操作签名：changebill(bill_id：int)
* 交叉引用：改签、购票、取消订单
* 前置条件：订单查看
* 后置条件：原来的票被取消，购买了新的票，多退少补

* 不变式：改签的起始点需一致，改签的新时间不能超过原始的24小时。

#### 3.4.8 购票

* 操作签名：beginbill（）
* 交叉引用：购票
* 前置条件：用户登录，用户账户余额不小于票价
* 后置条件：买到票，减少余额

* 不变式：无

#### 3.4.9 充值

* 操作签名：deposit（money:double）
* 交叉引用：充值
* 前置条件：用户登录
* 后置条件：余额增加

* 不变式：无

#### 3.4.10 系统管理员登录

* 操作签名：adminlogin（id：varchar，password：varchar）
* 交叉引用：系统管理员登录
* 前置条件：无
* 后置条件：登录系统管理员账户

* 不变式：无

#### 3.4.11 查看用户信息

* 操作签名：checkusers（userid：varchar）
* 交叉引用：管理用户信息
* 前置条件：系统管理员登录
* 后置条件：展示对应用户信息

* 不变式：不能展示用户的密码

#### 3.4.12 修正用户信息

* 操作签名：correctusers（element：varchar）
* 交叉引用：管理用户信息
* 前置条件：查看用户信息
* 后置条件：修改对应的用户信息

* 不变式：不能展示或修改用户的密码、id

#### 3.4.13 铁路系统员登录

* 操作签名：raillogin（id：varchar，password：varchar）
* 交叉引用：铁路系统员登录
* 前置条件：无
* 后置条件：登录铁路系统员账户

* 不变式：无

#### 3.4.14 查看车次信息

* 操作签名：checktrain（trainid：varchar）
* 交叉引用：修改车次信息
* 前置条件：铁路系统员登录
* 后置条件：展示对应车次信息

* 不变式：不能展示用户的密码

#### 3.4.15 修正车次信息

* 操作签名：correcttrain（element：varchar）
* 交叉引用：修改车次信息
* 前置条件：查看车次信息
* 后置条件：修改对应的车次信息，并为所有购买该车车票的用户退票

* 不变式：无

#### 3.4.16 删除车次信息

* 操作签名：deletetrain（）
* 交叉引用：修改车次信息
* 前置条件：查看车次信息
* 后置条件：删除对应车次，并为所有购买该车车票的用户退票

* 不变式：只能删除没有开始运行的车次

#### 3.4.17 添加车次信息

* 操作签名：addtrain（from：city，to：city，time：datetime）
* 交叉引用：修改车次信息
* 前置条件：铁路系统员登录
* 后置条件：添加车次

* 不变式：datetime必须晚于当前时间

## 4.软硬件及外部系统接口需求

### 4.1用户界面

* 按功能设计4组界面：

  * **购票功能**：
    设计入口界面、查询车票界面、提交订单界面、确认订单界面、付款界面提交改签申请界面和提交退票申请界面。
  * **个人主页**：
    设计登陆界面、个人主页界面、已购车票界面、历史订单界面、添加账户界面、消息界面和充值界面。
  * **管理员功能**：
    设计查询用户界面和用户信息界面。
  * **铁路系统员功能**：
    设计查询列车信息界面和添加列车信息界面。
* 界面设计风格：
  * 重点突出
    标题、关键字等加粗，风格以撞色为主，简化布局。
  * 简单易用
    多数页面不设计滚动功能，力求一屏之内展示全部内容。按钮设计背景颜色，力求醒目便捷。

### 4.2运行环境

* Web 浏览器：0+、Chrome、Opera、Safari、Firefox及任何支持HTML5标准的浏览器。
* 标准分辨率：1024*768、1920*1080、2K^[1]^

## 5.可靠性与可用性需求

### 5.1性能需求

* **处理能力**
  本系统核心功能为线上购票，起处理能力主要考虑系统能承载的最大并发用户数。按实际情况规划，系统至少需要承载的最大并发用户数达到全部注册用户的50%。
* **响应时间**
  在95％的情况下，一般时段响应时间不超过1.5秒，高峰时段不超过4秒。在非高峰时间根据起始地点和日期等特定条件进行搜索，可以在2秒内得到搜索结果。
  <center>响应时间需求表</center>

  <center>

  |时段|响应时间|
  |---|---|
  |19:00-21:30|<=4s|
  |其他时段|<=2s|
  |全时段95%情况|平均<=1.5s|
  
  </center>

### 5.2安全性需求

* **可靠性需求**：
  对全部输入检查输入数据是否合法，不合法发出警告，合法完成输入并提供反馈。

* **安全性需求**：
  严格权限访问控制，用户申请访问隐私信息时对用户身份进行额外核查并检查用户是否具有访问该信息的权限。保护数据不被非法/越权访问和篡改，要确保数据的机密性和完整性。

## 6.参考文献

[1]https://cloud.tencent.com/developer/article/1827262
